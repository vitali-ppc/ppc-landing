# üöÄ –ü–û–¢–û–ß–ù–ò–ô –°–¢–ê–¢–£–° –ü–†–û–ï–ö–¢–£ KAMPIO

**–î–∞—Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:** 6 —Å–µ—Ä–ø–Ω—è 2025  
**–í–µ—Ä—Å—ñ—è:** 1.0.0

---

## üéØ **–ú–ï–¢–ê –ü–†–û–ï–ö–¢–£**

–°—Ç–≤–æ—Ä–∏—Ç–∏ AI-–∞—Å–∏—Å—Ç–µ–Ω—Ç–∞ –¥–ª—è Google Ads –∑ —Ñ—É–Ω–∫—Ü—ñ—î—é **Smart Mode**, —è–∫–∏–π –º–æ–∂–µ:
- –ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ä–µ–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ Google Ads –∫–∞–º–ø–∞–Ω—ñ–π
- –ù–∞–¥–∞–≤–∞—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
- –ü—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ MCC (Manager) –∞–∫–∞—É–Ω—Ç–∞–º–∏ —Ç–∞ —ó—Ö –¥–æ—á—ñ—Ä–Ω—ñ–º–∏ –∞–∫–∞—É–Ω—Ç–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ access token —á–µ—Ä–µ–∑ refresh token

---

## ‚úÖ **–©–û –í–ñ–ï –ó–†–û–ë–õ–ï–ù–û**

### 1. **–ë—Ä–µ–Ω–¥–∏–Ω–≥ —Ç–∞ –¥–æ–º–µ–Ω**
- ‚úÖ –ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞–ª–∏ –ø—Ä–æ–µ–∫—Ç –∑ `ppcset` –Ω–∞ `kampaio`
- ‚úÖ –û–Ω–æ–≤–∏–ª–∏ –¥–æ–º–µ–Ω –∑ `ppcset.com` –Ω–∞ `kampaio.com`
- ‚úÖ –í–∏–ø—Ä–∞–≤–∏–ª–∏ –≤—Å—ñ localStorage –∫–ª—é—á—ñ (`ppcset-` ‚Üí `kampaio-`)
- ‚úÖ –û–Ω–æ–≤–∏–ª–∏ –º–µ—Ç–∞–¥–∞–Ω—ñ —Ç–∞ SEO —Ç–µ–≥–∏

### 2. **Google OAuth2 –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è**
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ OAuth2 –≤ Google Cloud Console
- ‚úÖ –î–æ–¥–∞–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ Client ID —Ç–∞ Client Secret –Ω–∞ Vercel
- ‚úÖ –í–∏–ø—Ä–∞–≤–∏–ª–∏ redirect URI –¥–ª—è `kampaio.com`
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ OAuth –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ—ó —Ä–æ–∑—Ä–æ–±–∫–∏ (`localhost:3002`)
- ‚úÖ –î–æ–¥–∞–ª–∏ `access_type=offline` –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è refresh token

### 3. **Refresh Token –õ–æ–≥—ñ–∫–∞ (–ß–∞—Å—Ç–∫–æ–≤–æ)**
- ‚úÖ –î–æ–¥–∞–ª–∏ —Ñ—É–Ω–∫—Ü—ñ—é `refresh_access_token()` –≤ AI —Å–µ—Ä–≤–µ—Ä
- ‚úÖ –î–æ–¥–∞–ª–∏ —Ñ—É–Ω–∫—Ü—ñ—é `get_valid_access_token()` –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º
- ‚úÖ –î–æ–¥–∞–ª–∏ retry –ª–æ–≥—ñ–∫—É –ø—Ä–∏ 401/403 –ø–æ–º–∏–ª–∫–∞—Ö
- ‚úÖ –î–æ–¥–∞–ª–∏ –∫–µ—à—É–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤ –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ –ø–µ—Ä–µ–¥–∞—á—É refresh_token –∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –Ω–∞ –±–µ–∫–µ–Ω–¥
- ‚ùå **–ù–ï –ü–†–ê–¶–Æ–Ñ:** –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤ —á–µ—Ä–µ–∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å credentials –Ω–∞ AI —Å–µ—Ä–≤–µ—Ä—ñ

### 4. **–î–µ—Ç–∞–ª—å–Ω–µ –õ–æ–≥—É–≤–∞–Ω–Ω—è**
- ‚úÖ –î–æ–¥–∞–ª–∏ –¥–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ (–∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞)
- ‚úÖ –î–æ–¥–∞–ª–∏ –¥–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏ –≤ –ø—Ä–æ–∫—Å—ñ (`/api/ads-data-real`)
- ‚úÖ –î–æ–¥–∞–ª–∏ –¥–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏ –≤ AI —Å–µ—Ä–≤–µ—Ä—ñ –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- ‚úÖ –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏: refresh_token –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–¥–æ–≤–∂–∏–Ω–∞ 103 —Å–∏–º–≤–æ–ª–∏)

### 5. **AI –°–µ—Ä–≤–µ—Ä (Hetzner)**
- ‚úÖ –†–æ–∑–≥–æ—Ä–Ω—É–ª–∏ AI —Å–µ—Ä–≤–µ—Ä –Ω–∞ Hetzner (91.99.225.211:8000)
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑ `docker-compose.yml`
- ‚úÖ –î–æ–¥–∞–ª–∏ –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è:
  - `GOOGLE_ADS_CUSTOMER_ID=852-476-3350`
  - `GOOGLE_ADS_DEVELOPER_TOKEN=N3foJOv65_q8B_rtOJsZiQ`
  - `OPENAI_API_KEY`
- ‚ùå **–í–Ü–î–°–£–¢–ù–Ü:** `GOOGLE_CLIENT_ID` —Ç–∞ `GOOGLE_CLIENT_SECRET` –Ω–∞ AI —Å–µ—Ä–≤–µ—Ä—ñ

### 6. **Frontend —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è**
- ‚úÖ –°—Ç–≤–æ—Ä–∏–ª–∏ `/api/ads-data-real` endpoint –¥–ª—è –ø—Ä–æ–∫—Å—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è `accessToken` —Ç–∞ `refreshToken` –≤ localStorage
- ‚úÖ –í–∏–ø—Ä–∞–≤–∏–ª–∏ OAuth callback –æ–±—Ä–æ–±–∫—É –∑ `setTimeout`
- ‚úÖ –û–Ω–æ–≤–∏–ª–∏ –ª–æ–≥—ñ–∫—É Smart Mode –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- ‚úÖ –î–æ–¥–∞–ª–∏ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–¥–∞—á—ñ —Ç–æ–∫–µ–Ω—ñ–≤

### 7. **Deployment**
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ Vercel –¥–ª—è frontend (`kampaio.com`)
- ‚úÖ –ü—ñ–¥–∫–ª—é—á–∏–ª–∏ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ DNS –∑–∞–ø–∏—Å–∏ –≤ Cloudflare
- ‚úÖ –î–æ–¥–∞–ª–∏ Environment Variables –≤ Vercel

### 8. **API –í–µ—Ä—Å—ñ—ó (–ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏)**
- ‚úÖ –¢–µ—Å—Ç—É–≤–∞–ª–∏ Google Ads API v15 ‚Üí –Ω–µ –ø—Ä–∞—Ü—é—î (404 –ø–æ–º–∏–ª–∫–∏)
- ‚úÖ –û–Ω–æ–≤–∏–ª–∏ –∑ v14 –¥–æ v20 ‚Üí –ø—ñ–¥—Ç—Ä–∏–º—É—î `customers:listAccessibleCustomers`
- ‚úÖ **–ì–û–¢–û–í–û:** v20 –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø–æ—Ç—Ä—ñ–±–Ω—ñ endpoints

---

## üöß **–ü–û–¢–û–ß–ù–Ü –ü–†–û–ë–õ–ï–ú–ò**

### **–ü—Ä–æ–±–ª–µ–º–∞ 1: Google OAuth Credentials**
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ –≤–∏—Ä—ñ—à–µ–Ω–æ
- **–î–µ—Ç–∞–ª—ñ:** AI —Å–µ—Ä–≤–µ—Ä –º–∞—î —Å—Ç–∞—Ä—ñ/–≤–∏–¥–∞–ª–µ–Ω—ñ Google OAuth credentials
- **–õ–æ–≥–∏:** `"error": "deleted_client", "error_description": "The OAuth client was deleted."`
- **–†—ñ—à–µ–Ω–Ω—è:** –û–Ω–æ–≤–∏—Ç–∏ `GOOGLE_CLIENT_ID` —Ç–∞ `GOOGLE_CLIENT_SECRET` –Ω–∞ AI —Å–µ—Ä–≤–µ—Ä—ñ –∞–∫—Ç—É–∞–ª—å–Ω–∏–º–∏ credentials

### **–ü—Ä–æ–±–ª–µ–º–∞ 2: Google Ads API –í–µ—Ä—Å—ñ—è**
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ –≤–∏—Ä—ñ—à–µ–Ω–æ
- **–î–µ—Ç–∞–ª—ñ:** v20 –ø—ñ–¥—Ç—Ä–∏–º—É—î `customers:listAccessibleCustomers` —Ç–∞ `searchStream` –¥–ª—è MCC –∞–∫–∞—É–Ω—Ç—ñ–≤
- **–õ–æ–≥–∏:** 
  - `The requested URL /v20/customers:listAccessibleCustomers was not found`
  - `The requested URL /v20/customers/8524763350/googleAds:searchStream was not found`
- **–†—ñ—à–µ–Ω–Ω—è:** v20 –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø–æ—Ç—Ä—ñ–±–Ω—ñ endpoints, —Ç–µ—Å—Ç—É—î–º–æ

### **–ü—Ä–æ–±–ª–µ–º–∞ 3: MCC Account Handling**
- **–°—Ç–∞—Ç—É—Å:** üîÑ –í –ø—Ä–æ—Ü–µ—Å—ñ
- **–î–µ—Ç–∞–ª—ñ:** Customer ID 852-476-3350 - —Ü–µ MCC (Manager) –∞–∫–∞—É–Ω—Ç
- **–ü–æ—Ç—Ä—ñ–±–Ω–æ:** –°–ø–æ—á–∞—Ç–∫—É –∑–Ω–∞–π—Ç–∏ –¥–æ—á—ñ—Ä–Ω—ñ –∞–∫–∞—É–Ω—Ç–∏ —á–µ—Ä–µ–∑ `customers:listAccessibleCustomers`

---

## üìç **–ü–û–¢–û–ß–ù–ò–ô –ï–¢–ê–ü**

### **–°—Ç–∞—Ç—É—Å Smart Mode:**
- ‚úÖ OAuth –ø—Ä–∞—Ü—é—î - —Ç–æ–∫–µ–Ω –æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è
- ‚úÖ refreshToken –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–¥–æ–≤–∂–∏–Ω–∞ 103 —Å–∏–º–≤–æ–ª–∏)
- ‚úÖ AI —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω–∏–π —ñ –ø—Ä–∞—Ü—é—î
- ‚úÖ Google OAuth credentials —á–∏—Ç–∞—é—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚ùå **Smart Mode –≤—Å–µ —â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ**
- ‚ùå **Google Ads API –ø–æ–≤–µ—Ä—Ç–∞—î 404** –¥–ª—è MCC –∞–∫–∞—É–Ω—Ç–∞
- ‚ùå **Refresh token –ª–æ–≥—ñ–∫–∞ –Ω–µ –ø—Ä–∞—Ü—é—î** —á–µ—Ä–µ–∑ —Å—Ç–∞—Ä—ñ credentials ("deleted_client")

### **–î–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —Ç–µ—Å—Ç—É (6 —Å–µ—Ä–ø–Ω—è 2025):**
```
‚úÖ refreshToken –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è: [REDACTED]
‚úÖ accessToken –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è: [REDACTED]
‚úÖ GOOGLE_CLIENT_ID: present
‚úÖ GOOGLE_CLIENT_SECRET: present
‚ùå ERROR: "deleted_client" - The OAuth client was deleted
‚ùå ERROR: Failed to refresh token, using original: Token refresh failed: 401
‚ùå HTTP/1.1 404 Not Found: /v20/customers:listAccessibleCustomers
‚ùå HTTP/1.1 404 Not Found: /v20/customers/8524763350/googleAds:searchStream
```

### **–û—Å—Ç–∞–Ω–Ω—ñ —Ç–µ—Å—Ç–∏ (6 —Å–µ—Ä–ø–Ω—è 2025):**
- ‚úÖ **–¢–µ—Å—Ç—É–≤–∞–ª–∏ refresh token –ª–æ–≥—ñ–∫—É** - –ø–µ—Ä–µ–¥–∞—á–∞ –ø—Ä–∞—Ü—é—î (–¥–æ–≤–∂–∏–Ω–∞ 103 —Å–∏–º–≤–æ–ª–∏)
- ‚úÖ **–î–æ–¥–∞–ª–∏ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è** - –±–∞—á–∏–º–æ –≤—Å—ñ –µ—Ç–∞–ø–∏ –ø–µ—Ä–µ–¥–∞—á—ñ —Ç–æ–∫–µ–Ω—ñ–≤
- ‚úÖ **–ü–µ—Ä–µ–≤—ñ—Ä–∏–ª–∏ Google OAuth credentials** - –∑–º—ñ–Ω–Ω—ñ —á–∏—Ç–∞—é—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–ø–æ–∫–∞–∑—É—é—Ç—å "present")
- ‚ùå **Refresh token –æ–Ω–æ–≤–ª–µ–Ω–Ω—è** - –Ω–µ –ø—Ä–∞—Ü—é—î —á–µ—Ä–µ–∑ "deleted_client" –ø–æ–º–∏–ª–∫—É (—Å—Ç–∞—Ä—ñ credentials)
- ‚ùå **Google Ads API v20** - —Ç–µ—Å—Ç—É—î–º–æ `customers:listAccessibleCustomers` (404 –ø–æ–º–∏–ª–∫–∞)
- ‚ùå **Google Ads API v20** - —Ç–µ—Å—Ç—É—î–º–æ `searchStream` –¥–ª—è MCC –∞–∫–∞—É–Ω—Ç—ñ–≤ (404 –ø–æ–º–∏–ª–∫–∞)

---

## üéØ **–ù–ê–°–¢–£–ü–ù–Ü –ö–†–û–ö–ò**

### **1. –û–Ω–æ–≤–∏—Ç–∏ Google OAuth Credentials**
- [ ] –û—Ç—Ä–∏–º–∞—Ç–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ñ `GOOGLE_CLIENT_ID` —Ç–∞ `GOOGLE_CLIENT_SECRET` –∑ Vercel
- [ ] –û–Ω–æ–≤–∏—Ç–∏ `.env` —Ñ–∞–π–ª –Ω–∞ AI —Å–µ—Ä–≤–µ—Ä—ñ
- [ ] –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ refresh token –ª–æ–≥—ñ–∫—É

### **2. –¢–µ—Å—Ç—É–≤–∞—Ç–∏ Google Ads API v20**
- [ ] –î–æ—Å–ª—ñ–¥–∏—Ç–∏ –º–µ—Ç–æ–¥–∏ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ MCC –∞–∫–∞—É–Ω—Ç–∞–º–∏ –≤ v20
- [ ] –ó–Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ endpoints –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–ø–∏—Å–∫—É –¥–æ—á—ñ—Ä–Ω—ñ—Ö –∞–∫–∞—É–Ω—Ç—ñ–≤
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ –ø—ñ–¥—Ö–æ–¥–∏ –¥–æ `searchStream`

### **3. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è MCC Handling**
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –º–µ—Ç–æ–¥–∏ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ MCC –∞–∫–∞—É–Ω—Ç–∞–º–∏ –≤ v20
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥—ñ–∫—É –ø–æ—à—É–∫—É –¥–æ—á—ñ—Ä–Ω—ñ—Ö –∞–∫–∞—É–Ω—Ç—ñ–≤ —á–µ—Ä–µ–∑ —ñ–Ω—à—ñ endpoints
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏ –¥–æ Google Ads API –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º –∞–∫–∞—É–Ω—Ç–æ–º

### **4. –§—ñ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è**
- [ ] –î–æ—Å—è–≥—Ç–∏ —Ä–æ–±–æ—á–æ–≥–æ Smart Mode –∑ —Ä–µ–∞–ª—å–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –∞–Ω–∞–ª—ñ–∑ –∫–∞–º–ø–∞–Ω—ñ–π
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —á–∞—Ç—É

---

## üîß **–¢–ï–•–ù–Ü–ß–ù–Ü –î–ï–¢–ê–õ–Ü**

### **–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞:**
```
Frontend (Vercel) ‚Üí /api/ads-data-real ‚Üí AI Server (Hetzner) ‚Üí Google Ads API
```

### **Refresh Token Flow (–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω):**
```
1. OAuth Callback ‚Üí –æ—Ç—Ä–∏–º—É—î access_token + refresh_token ‚úÖ
2. Frontend ‚Üí –∑–±–µ—Ä—ñ–≥–∞—î –æ–±–∏–¥–≤–∞ —Ç–æ–∫–µ–Ω–∏ –≤ localStorage ‚úÖ
3. Smart Mode ‚Üí –ø–µ—Ä–µ–¥–∞—î –æ–±–∏–¥–≤–∞ —Ç–æ–∫–µ–Ω–∏ –Ω–∞ AI —Å–µ—Ä–≤–µ—Ä ‚úÖ
4. AI Server ‚Üí –æ—Ç—Ä–∏–º—É—î refresh_token (–¥–æ–≤–∂–∏–Ω–∞ 103 —Å–∏–º–≤–æ–ª–∏) ‚úÖ
5. AI Server ‚Üí –ù–ï –ú–û–ñ–ï –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ access_token (—Å—Ç–∞—Ä—ñ credentials) ‚ùå
6. AI Server ‚Üí —Ä–æ–±–∏—Ç—å –∑–∞–ø–∏—Ç–∏ –¥–æ Google Ads API –∑ –ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–∏–º —Ç–æ–∫–µ–Ω–æ–º ‚ùå
```

### **Refresh Token Flow (–ü–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏—Ä—ñ—à–∏—Ç–∏):**
**–í–∞—Ä—ñ–∞–Ω—Ç 1 (–ë–µ–∑–ø–µ—á–Ω–∏–π):**
```
1. Frontend ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é—î access_token –∫–æ–∂–Ω—ñ 55 —Ö–≤
2. Frontend ‚Üí –ø–µ—Ä–µ–¥–∞—î —Å–≤—ñ–∂–∏–π access_token –Ω–∞ AI —Å–µ—Ä–≤–µ—Ä
3. AI Server ‚Üí –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–≤—ñ–∂–∏–π —Ç–æ–∫–µ–Ω –±–µ–∑ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
```

**–í–∞—Ä—ñ–∞–Ω—Ç 2 (–ü—Ä–æ—Å—Ç–∏–π):**
```
1. AI Server ‚Üí –º–∞—î credentials –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤
2. AI Server ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é—î access_token –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ
3. AI Server ‚Üí —Ä–æ–±–∏—Ç—å –∑–∞–ø–∏—Ç–∏ –∑ –≤–∞–ª—ñ–¥–Ω–∏–º —Ç–æ–∫–µ–Ω–æ–º
```

### **–ö–ª—é—á–æ–≤—ñ —Ñ–∞–π–ª–∏:**
- `src/app/api/ads-data-real/route.ts` - –ø—Ä–æ–∫—Å—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤
- `ai-server/main.py` - –ª–æ–≥—ñ–∫–∞ –æ–±—Ä–æ–±–∫–∏ MCC –∞–∫–∞—É–Ω—Ç—ñ–≤ —Ç–∞ refresh token
- `src/components/chat/hooks/useChatActions.ts` - Smart Mode –ª–æ–≥—ñ–∫–∞
- `src/components/chat/index.tsx` - OAuth callback –æ–±—Ä–æ–±–∫–∞

### **Environment Variables:**
```bash
# Frontend (Vercel)
GOOGLE_CLIENT_ID=your_google_client_id_here
GOOGLE_CLIENT_SECRET=your_google_client_secret_here
NEXT_PUBLIC_APP_URL=https://kampaio.com
BACKEND_URL=http://91.99.225.211:8000

# AI Server (Hetzner) - –ü–û–¢–†–Ü–ë–ù–û –î–û–î–ê–¢–ò
GOOGLE_CLIENT_ID=your_google_client_id_here
GOOGLE_CLIENT_SECRET=your_google_client_secret_here
GOOGLE_ADS_CUSTOMER_ID=852-476-3350
GOOGLE_ADS_DEVELOPER_TOKEN=N3foJOv65_q8B_rtOJsZiQ
OPENAI_API_KEY=...
```

---

## üìä **–°–¢–ê–¢–£–° –ö–û–ú–ü–û–ù–ï–ù–¢–Ü–í**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º—ñ—Ç–∫–∏ |
|-----------|--------|----------|
| Frontend (Vercel) | ‚úÖ –ü—Ä–∞—Ü—é—î | `kampaio.com` –¥–æ—Å—Ç—É–ø–Ω–∏–π |
| AI Server (Hetzner) | ‚úÖ –ü—Ä–∞—Ü—é—î | –ü–æ—Ä—Ç 8000 –∞–∫—Ç–∏–≤–Ω–∏–π |
| Google OAuth2 | ‚úÖ –ü—Ä–∞—Ü—é—î | –¢–æ–∫–µ–Ω–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å—Å—è |
| Refresh Token Logic | üîÑ –ü–æ—Ç—Ä–µ–±—É—î —Ä—ñ—à–µ–Ω–Ω—è | –ü–µ—Ä–µ–¥–∞—á–∞ –ø—Ä–∞—Ü—é—î, –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ –ø—Ä–∞—Ü—é—î —á–µ—Ä–µ–∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å credentials |
| Smart Mode | ‚ùå –ù–µ –ø—Ä–∞—Ü—é—î | MCC –ø—Ä–æ–±–ª–µ–º–∞ + API –≤–µ—Ä—Å—ñ—è |
| MCC Handling | üîÑ –í –ø—Ä–æ—Ü–µ—Å—ñ | v20 API –≥–æ—Ç–æ–≤–∞ |

---

## üö® **–í–Ü–î–û–ú–Ü –ü–†–û–ë–õ–ï–ú–ò**

1. **GitHub Push Protection** - –±–ª–æ–∫—É—î push –∑ —Å–µ–∫—Ä–µ—Ç–∞–º–∏ –≤ —ñ—Å—Ç–æ—Ä—ñ—ó
2. **MCC Account API** - –ø–æ—Ç—Ä–µ–±—É—î —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏
3. **API Version Compatibility** - v20 –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø–æ—Ç—Ä—ñ–±–Ω—ñ endpoints
4. **Refresh Token Architecture** - –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏—Ä—ñ—à–∏—Ç–∏ –¥–µ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Ç–æ–∫–µ–Ω–∏ (—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ vs –±–µ–∫–µ–Ω–¥)

---

## üìã **–î–ï–¢–ê–õ–¨–ù–ò–ô –û–ü–ò–° –†–û–ë–û–¢–ò**

### **–©–æ –º–∏ —Ä–æ–±–∏–ª–∏ –ø–æ–µ—Ç–∞–ø–Ω–æ:**

1. **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è OAuth2 —Ç–∞ –ø–µ—Ä–µ–¥–∞—á–∞ —Ç–æ–∫–µ–Ω—ñ–≤:**
   - –ù–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ Google OAuth2 –∑ `access_type=offline` –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è refresh_token
   - –†–µ–∞–ª—ñ–∑—É–≤–∞–ª–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –æ–±–æ—Ö —Ç–æ–∫–µ–Ω—ñ–≤ –≤ localStorage
   - –î–æ–¥–∞–ª–∏ –ø–µ—Ä–µ–¥–∞—á—É refresh_token –∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –Ω–∞ AI —Å–µ—Ä–≤–µ—Ä
   - –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏: refresh_token –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–¥–æ–≤–∂–∏–Ω–∞ 103 —Å–∏–º–≤–æ–ª–∏)

2. **–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è refresh token –ª–æ–≥—ñ–∫–∏ –Ω–∞ AI —Å–µ—Ä–≤–µ—Ä—ñ:**
   - –î–æ–¥–∞–ª–∏ —Ñ—É–Ω–∫—Ü—ñ—é `refresh_access_token()` –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤
   - –î–æ–¥–∞–ª–∏ —Ñ—É–Ω–∫—Ü—ñ—é `get_valid_access_token()` –∑ –∫–µ—à—É–≤–∞–Ω–Ω—è–º
   - –î–æ–¥–∞–ª–∏ retry –ª–æ–≥—ñ–∫—É –ø—Ä–∏ 401/403 –ø–æ–º–∏–ª–∫–∞—Ö
   - **–ü–†–û–ë–õ–ï–ú–ê:** AI —Å–µ—Ä–≤–µ—Ä –Ω–µ –º–∞—î `GOOGLE_CLIENT_ID` —Ç–∞ `GOOGLE_CLIENT_SECRET`

3. **–ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏ –∑ Google Ads API –≤–µ—Ä—Å—ñ—è–º–∏:**
   - –¢–µ—Å—Ç—É–≤–∞–ª–∏ v15 ‚Üí –æ—Ç—Ä–∏–º—É–≤–∞–ª–∏ 404 –ø–æ–º–∏–ª–∫–∏
   - –û–Ω–æ–≤–∏–ª–∏ –¥–æ v20 ‚Üí –ø—ñ–¥—Ç—Ä–∏–º—É—î `customers:listAccessibleCustomers`
   - **–í–ò–°–ù–û–í–û–ö:** v20 –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø–æ—Ç—Ä—ñ–±–Ω—ñ endpoints

4. **–î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:**
   - –î–æ–¥–∞–ª–∏ –ª–æ–≥–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ (–∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞)
   - –î–æ–¥–∞–ª–∏ –ª–æ–≥–∏ –≤ –ø—Ä–æ–∫—Å—ñ (`/api/ads-data-real`)
   - –î–æ–¥–∞–ª–∏ –¥–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏ –≤ AI —Å–µ—Ä–≤–µ—Ä—ñ
   - –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏ –≤—Å—ñ –µ—Ç–∞–ø–∏ –ø–µ—Ä–µ–¥–∞—á—ñ —Ç–æ–∫–µ–Ω—ñ–≤

### **–ü–æ—Ç–æ—á–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ —Ç–∞ —ó—Ö –ø—Ä–∏—á–∏–Ω–∏:**

1. **Refresh token –Ω–µ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è:**
   - **–ü—Ä–∏—á–∏–Ω–∞:** AI —Å–µ—Ä–≤–µ—Ä –Ω–µ –º–∞—î `GOOGLE_CLIENT_ID` —Ç–∞ `GOOGLE_CLIENT_SECRET`
   - **–†—ñ—à–µ–Ω–Ω—è:** –∞–±–æ –¥–æ–¥–∞—Ç–∏ credentials –Ω–∞ AI —Å–µ—Ä–≤–µ—Ä, –∞–±–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ

2. **Google Ads API 404 –ø–æ–º–∏–ª–∫–∏:**
   - **–ü—Ä–∏—á–∏–Ω–∞:** v20 –ø—ñ–¥—Ç—Ä–∏–º—É—î `customers:listAccessibleCustomers`
   - **–†—ñ—à–µ–Ω–Ω—è:** v20 –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø–æ—Ç—Ä—ñ–±–Ω—ñ endpoints

3. **MCC Account Handling:**
   - **–ü—Ä–∏—á–∏–Ω–∞:** Customer ID 852-476-3350 - —Ü–µ MCC –∞–∫–∞—É–Ω—Ç
   - **–†—ñ—à–µ–Ω–Ω—è:** —Å–ø–æ—á–∞—Ç–∫—É –∑–Ω–∞–π—Ç–∏ –¥–æ—á—ñ—Ä–Ω—ñ –∞–∫–∞—É–Ω—Ç–∏ —á–µ—Ä–µ–∑ `customers:listAccessibleCustomers`

---

## üìû **–ö–û–ù–¢–ê–ö–¢–ò –¢–ê –†–ï–°–£–†–°–ò**

- **GitHub:** https://github.com/vitali-ppc/ppc-landing
- **Vercel:** https://vercel.com/vitalis-projects-db8014b4/ppc-landing
- **AI Server:** http://91.99.225.211:8000
- **Production:** https://kampaio.com

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –æ–Ω–æ–≤–ª–µ–Ω–∞: 6 —Å–µ—Ä–ø–Ω—è 2025* 